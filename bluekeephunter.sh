#!/bin/bash
echo -e "
██████╗ ██╗     ██╗   ██╗███████╗██╗  ██╗███████╗███████╗██████╗     ██╗  ██╗██╗   ██╗███╗   ██╗████████╗███████╗██████╗ 
██╔══██╗██║     ██║   ██║██╔════╝██║ ██╔╝██╔════╝██╔════╝██╔══██╗    ██║  ██║██║   ██║████╗  ██║╚══██╔══╝██╔════╝██╔══██╗
██████╔╝██║     ██║   ██║█████╗  █████╔╝ █████╗  █████╗  ██████╔╝    ███████║██║   ██║██╔██╗ ██║   ██║   █████╗  ██████╔╝
██╔══██╗██║     ██║   ██║██╔══╝  ██╔═██╗ ██╔══╝  ██╔══╝  ██╔═══╝     ██╔══██║██║   ██║██║╚██╗██║   ██║   ██╔══╝  ██╔══██╗
██████╔╝███████╗╚██████╔╝███████╗██║  ██╗███████╗███████╗██║         ██║  ██║╚██████╔╝██║ ╚████║   ██║   ███████╗██║  ██║
╚═════╝ ╚══════╝ ╚═════╝ ╚══════╝╚═╝  ╚═╝╚══════╝╚══════╝╚═╝         ╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═══╝   ╚═╝   ╚══════╝╚═╝  ╚═╝
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|C|V|E|-|2|0|1|9|-|0|7|0|8|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
--- Ravaan[https://debprasadbanerjee502.medium.com]"

lis=$1

if [ $1 == '-h' ]
then
	echo "Usage: ./bluekeephunter.sh targets.txt"
else
	cat $lis>vuln.list
	for i in `grep -E -o "(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)" vuln.list`; do msfconsole -q -x " use scanner/rdp/cve_2019_0708_bluekeep; set rhost $i; exploit; exit;"; done;
fi
